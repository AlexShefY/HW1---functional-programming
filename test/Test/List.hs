
module Test.List where

import Test.Tasty.HUnit (Assertion, (@?=))

import List

unit_take = do
    test 0 [1,2]
    test 1 [1,2]
    test 2 [1,2]
    test 3 [1,2]
    test 0 []
    test 1 []
  where
    test :: Int -> [Int] -> Assertion
    test n xs = take' n xs @?= take n xs

unit_filter = do
    test (== 13) [0..100]
    test (<= 13) [0..100]
    test (>= 13) [0..100]
  where
    test p xs = filter' p xs @?= filter p xs

unit_zipWith' = do
    test ((,)) [1,2,3] [4,5]
    test ((,)) [1,2] [3,4,5]
    test ((,)) [1,2,3] [4,5,6]
    test ((,)) [] [1,2,3]
    test ((,)) [1,2,3] []
  where
    test :: (Int -> Int -> (Int, Int)) -> [Int] -> [Int] -> Assertion
    test f xs ys = zipWith' f xs ys @?= zipWith f xs ys

unit_squaresOfEvens = do
    take 1000 squaresOfEvens @?= [0,4,16,36,64,100,144,196,256,324,400,484,576,676,784,900,1024,1156,1296,1444,1600,1764,1936,2116,2304,2500,2704,2916,3136,3364,3600,3844,4096,4356,4624,4900,5184,5476,5776,6084,6400,6724,7056,7396,7744,8100,8464,8836,9216,9604,10000,10404,10816,11236,11664,12100,12544,12996,13456,13924,14400,14884,15376,15876,16384,16900,17424,17956,18496,19044,19600,20164,20736,21316,21904,22500,23104,23716,24336,24964,25600,26244,26896,27556,28224,28900,29584,30276,30976,31684,32400,33124,33856,34596,35344,36100,36864,37636,38416,39204,40000,40804,41616,42436,43264,44100,44944,45796,46656,47524,48400,49284,50176,51076,51984,52900,53824,54756,55696,56644,57600,58564,59536,60516,61504,62500,63504,64516,65536,66564,67600,68644,69696,70756,71824,72900,73984,75076,76176,77284,78400,79524,80656,81796,82944,84100,85264,86436,87616,88804,90000,91204,92416,93636,94864,96100,97344,98596,99856,101124,102400,103684,104976,106276,107584,108900,110224,111556,112896,114244,115600,116964,118336,119716,121104,122500,123904,125316,126736,128164,129600,131044,132496,133956,135424,136900,138384,139876,141376,142884,144400,145924,147456,148996,150544,152100,153664,155236,156816,158404,160000,161604,163216,164836,166464,168100,169744,171396,173056,174724,176400,178084,179776,181476,183184,184900,186624,188356,190096,191844,193600,195364,197136,198916,200704,202500,204304,206116,207936,209764,211600,213444,215296,217156,219024,220900,222784,224676,226576,228484,230400,232324,234256,236196,238144,240100,242064,244036,246016,248004,250000,252004,254016,256036,258064,260100,262144,264196,266256,268324,270400,272484,274576,276676,278784,280900,283024,285156,287296,289444,291600,293764,295936,298116,300304,302500,304704,306916,309136,311364,313600,315844,318096,320356,322624,324900,327184,329476,331776,334084,336400,338724,341056,343396,345744,348100,350464,352836,355216,357604,360000,362404,364816,367236,369664,372100,374544,376996,379456,381924,384400,386884,389376,391876,394384,396900,399424,401956,404496,407044,409600,412164,414736,417316,419904,422500,425104,427716,430336,432964,435600,438244,440896,443556,446224,448900,451584,454276,456976,459684,462400,465124,467856,470596,473344,476100,478864,481636,484416,487204,490000,492804,495616,498436,501264,504100,506944,509796,512656,515524,518400,521284,524176,527076,529984,532900,535824,538756,541696,544644,547600,550564,553536,556516,559504,562500,565504,568516,571536,574564,577600,580644,583696,586756,589824,592900,595984,599076,602176,605284,608400,611524,614656,617796,620944,624100,627264,630436,633616,636804,640000,643204,646416,649636,652864,656100,659344,662596,665856,669124,672400,675684,678976,682276,685584,688900,692224,695556,698896,702244,705600,708964,712336,715716,719104,722500,725904,729316,732736,736164,739600,743044,746496,749956,753424,756900,760384,763876,767376,770884,774400,777924,781456,784996,788544,792100,795664,799236,802816,806404,810000,813604,817216,820836,824464,828100,831744,835396,839056,842724,846400,850084,853776,857476,861184,864900,868624,872356,876096,879844,883600,887364,891136,894916,898704,902500,906304,910116,913936,917764,921600,925444,929296,933156,937024,940900,944784,948676,952576,956484,960400,964324,968256,972196,976144,980100,984064,988036,992016,996004,1000000,1004004,1008016,1012036,1016064,1020100,1024144,1028196,1032256,1036324,1040400,1044484,1048576,1052676,1056784,1060900,1065024,1069156,1073296,1077444,1081600,1085764,1089936,1094116,1098304,1102500,1106704,1110916,1115136,1119364,1123600,1127844,1132096,1136356,1140624,1144900,1149184,1153476,1157776,1162084,1166400,1170724,1175056,1179396,1183744,1188100,1192464,1196836,1201216,1205604,1210000,1214404,1218816,1223236,1227664,1232100,1236544,1240996,1245456,1249924,1254400,1258884,1263376,1267876,1272384,1276900,1281424,1285956,1290496,1295044,1299600,1304164,1308736,1313316,1317904,1322500,1327104,1331716,1336336,1340964,1345600,1350244,1354896,1359556,1364224,1368900,1373584,1378276,1382976,1387684,1392400,1397124,1401856,1406596,1411344,1416100,1420864,1425636,1430416,1435204,1440000,1444804,1449616,1454436,1459264,1464100,1468944,1473796,1478656,1483524,1488400,1493284,1498176,1503076,1507984,1512900,1517824,1522756,1527696,1532644,1537600,1542564,1547536,1552516,1557504,1562500,1567504,1572516,1577536,1582564,1587600,1592644,1597696,1602756,1607824,1612900,1617984,1623076,1628176,1633284,1638400,1643524,1648656,1653796,1658944,1664100,1669264,1674436,1679616,1684804,1690000,1695204,1700416,1705636,1710864,1716100,1721344,1726596,1731856,1737124,1742400,1747684,1752976,1758276,1763584,1768900,1774224,1779556,1784896,1790244,1795600,1800964,1806336,1811716,1817104,1822500,1827904,1833316,1838736,1844164,1849600,1855044,1860496,1865956,1871424,1876900,1882384,1887876,1893376,1898884,1904400,1909924,1915456,1920996,1926544,1932100,1937664,1943236,1948816,1954404,1960000,1965604,1971216,1976836,1982464,1988100,1993744,1999396,2005056,2010724,2016400,2022084,2027776,2033476,2039184,2044900,2050624,2056356,2062096,2067844,2073600,2079364,2085136,2090916,2096704,2102500,2108304,2114116,2119936,2125764,2131600,2137444,2143296,2149156,2155024,2160900,2166784,2172676,2178576,2184484,2190400,2196324,2202256,2208196,2214144,2220100,2226064,2232036,2238016,2244004,2250000,2256004,2262016,2268036,2274064,2280100,2286144,2292196,2298256,2304324,2310400,2316484,2322576,2328676,2334784,2340900,2347024,2353156,2359296,2365444,2371600,2377764,2383936,2390116,2396304,2402500,2408704,2414916,2421136,2427364,2433600,2439844,2446096,2452356,2458624,2464900,2471184,2477476,2483776,2490084,2496400,2502724,2509056,2515396,2521744,2528100,2534464,2540836,2547216,2553604,2560000,2566404,2572816,2579236,2585664,2592100,2598544,2604996,2611456,2617924,2624400,2630884,2637376,2643876,2650384,2656900,2663424,2669956,2676496,2683044,2689600,2696164,2702736,2709316,2715904,2722500,2729104,2735716,2742336,2748964,2755600,2762244,2768896,2775556,2782224,2788900,2795584,2802276,2808976,2815684,2822400,2829124,2835856,2842596,2849344,2856100,2862864,2869636,2876416,2883204,2890000,2896804,2903616,2910436,2917264,2924100,2930944,2937796,2944656,2951524,2958400,2965284,2972176,2979076,2985984,2992900,2999824,3006756,3013696,3020644,3027600,3034564,3041536,3048516,3055504,3062500,3069504,3076516,3083536,3090564,3097600,3104644,3111696,3118756,3125824,3132900,3139984,3147076,3154176,3161284,3168400,3175524,3182656,3189796,3196944,3204100,3211264,3218436,3225616,3232804,3240000,3247204,3254416,3261636,3268864,3276100,3283344,3290596,3297856,3305124,3312400,3319684,3326976,3334276,3341584,3348900,3356224,3363556,3370896,3378244,3385600,3392964,3400336,3407716,3415104,3422500,3429904,3437316,3444736,3452164,3459600,3467044,3474496,3481956,3489424,3496900,3504384,3511876,3519376,3526884,3534400,3541924,3549456,3556996,3564544,3572100,3579664,3587236,3594816,3602404,3610000,3617604,3625216,3632836,3640464,3648100,3655744,3663396,3671056,3678724,3686400,3694084,3701776,3709476,3717184,3724900,3732624,3740356,3748096,3755844,3763600,3771364,3779136,3786916,3794704,3802500,3810304,3818116,3825936,3833764,3841600,3849444,3857296,3865156,3873024,3880900,3888784,3896676,3904576,3912484,3920400,3928324,3936256,3944196,3952144,3960100,3968064,3976036,3984016,3992004]

unit_triangularNumbers = do
    take 1000 triangularNumbers @?= [0,1,3,6,10,15,21,28,36,45,55,66,78,91,105,120,136,153,171,190,210,231,253,276,300,325,351,378,406,435,465,496,528,561,595,630,666,703,741,780,820,861,903,946,990,1035,1081,1128,1176,1225,1275,1326,1378,1431,1485,1540,1596,1653,1711,1770,1830,1891,1953,2016,2080,2145,2211,2278,2346,2415,2485,2556,2628,2701,2775,2850,2926,3003,3081,3160,3240,3321,3403,3486,3570,3655,3741,3828,3916,4005,4095,4186,4278,4371,4465,4560,4656,4753,4851,4950,5050,5151,5253,5356,5460,5565,5671,5778,5886,5995,6105,6216,6328,6441,6555,6670,6786,6903,7021,7140,7260,7381,7503,7626,7750,7875,8001,8128,8256,8385,8515,8646,8778,8911,9045,9180,9316,9453,9591,9730,9870,10011,10153,10296,10440,10585,10731,10878,11026,11175,11325,11476,11628,11781,11935,12090,12246,12403,12561,12720,12880,13041,13203,13366,13530,13695,13861,14028,14196,14365,14535,14706,14878,15051,15225,15400,15576,15753,15931,16110,16290,16471,16653,16836,17020,17205,17391,17578,17766,17955,18145,18336,18528,18721,18915,19110,19306,19503,19701,19900,20100,20301,20503,20706,20910,21115,21321,21528,21736,21945,22155,22366,22578,22791,23005,23220,23436,23653,23871,24090,24310,24531,24753,24976,25200,25425,25651,25878,26106,26335,26565,26796,27028,27261,27495,27730,27966,28203,28441,28680,28920,29161,29403,29646,29890,30135,30381,30628,30876,31125,31375,31626,31878,32131,32385,32640,32896,33153,33411,33670,33930,34191,34453,34716,34980,35245,35511,35778,36046,36315,36585,36856,37128,37401,37675,37950,38226,38503,38781,39060,39340,39621,39903,40186,40470,40755,41041,41328,41616,41905,42195,42486,42778,43071,43365,43660,43956,44253,44551,44850,45150,45451,45753,46056,46360,46665,46971,47278,47586,47895,48205,48516,48828,49141,49455,49770,50086,50403,50721,51040,51360,51681,52003,52326,52650,52975,53301,53628,53956,54285,54615,54946,55278,55611,55945,56280,56616,56953,57291,57630,57970,58311,58653,58996,59340,59685,60031,60378,60726,61075,61425,61776,62128,62481,62835,63190,63546,63903,64261,64620,64980,65341,65703,66066,66430,66795,67161,67528,67896,68265,68635,69006,69378,69751,70125,70500,70876,71253,71631,72010,72390,72771,73153,73536,73920,74305,74691,75078,75466,75855,76245,76636,77028,77421,77815,78210,78606,79003,79401,79800,80200,80601,81003,81406,81810,82215,82621,83028,83436,83845,84255,84666,85078,85491,85905,86320,86736,87153,87571,87990,88410,88831,89253,89676,90100,90525,90951,91378,91806,92235,92665,93096,93528,93961,94395,94830,95266,95703,96141,96580,97020,97461,97903,98346,98790,99235,99681,100128,100576,101025,101475,101926,102378,102831,103285,103740,104196,104653,105111,105570,106030,106491,106953,107416,107880,108345,108811,109278,109746,110215,110685,111156,111628,112101,112575,113050,113526,114003,114481,114960,115440,115921,116403,116886,117370,117855,118341,118828,119316,119805,120295,120786,121278,121771,122265,122760,123256,123753,124251,124750,125250,125751,126253,126756,127260,127765,128271,128778,129286,129795,130305,130816,131328,131841,132355,132870,133386,133903,134421,134940,135460,135981,136503,137026,137550,138075,138601,139128,139656,140185,140715,141246,141778,142311,142845,143380,143916,144453,144991,145530,146070,146611,147153,147696,148240,148785,149331,149878,150426,150975,151525,152076,152628,153181,153735,154290,154846,155403,155961,156520,157080,157641,158203,158766,159330,159895,160461,161028,161596,162165,162735,163306,163878,164451,165025,165600,166176,166753,167331,167910,168490,169071,169653,170236,170820,171405,171991,172578,173166,173755,174345,174936,175528,176121,176715,177310,177906,178503,179101,179700,180300,180901,181503,182106,182710,183315,183921,184528,185136,185745,186355,186966,187578,188191,188805,189420,190036,190653,191271,191890,192510,193131,193753,194376,195000,195625,196251,196878,197506,198135,198765,199396,200028,200661,201295,201930,202566,203203,203841,204480,205120,205761,206403,207046,207690,208335,208981,209628,210276,210925,211575,212226,212878,213531,214185,214840,215496,216153,216811,217470,218130,218791,219453,220116,220780,221445,222111,222778,223446,224115,224785,225456,226128,226801,227475,228150,228826,229503,230181,230860,231540,232221,232903,233586,234270,234955,235641,236328,237016,237705,238395,239086,239778,240471,241165,241860,242556,243253,243951,244650,245350,246051,246753,247456,248160,248865,249571,250278,250986,251695,252405,253116,253828,254541,255255,255970,256686,257403,258121,258840,259560,260281,261003,261726,262450,263175,263901,264628,265356,266085,266815,267546,268278,269011,269745,270480,271216,271953,272691,273430,274170,274911,275653,276396,277140,277885,278631,279378,280126,280875,281625,282376,283128,283881,284635,285390,286146,286903,287661,288420,289180,289941,290703,291466,292230,292995,293761,294528,295296,296065,296835,297606,298378,299151,299925,300700,301476,302253,303031,303810,304590,305371,306153,306936,307720,308505,309291,310078,310866,311655,312445,313236,314028,314821,315615,316410,317206,318003,318801,319600,320400,321201,322003,322806,323610,324415,325221,326028,326836,327645,328455,329266,330078,330891,331705,332520,333336,334153,334971,335790,336610,337431,338253,339076,339900,340725,341551,342378,343206,344035,344865,345696,346528,347361,348195,349030,349866,350703,351541,352380,353220,354061,354903,355746,356590,357435,358281,359128,359976,360825,361675,362526,363378,364231,365085,365940,366796,367653,368511,369370,370230,371091,371953,372816,373680,374545,375411,376278,377146,378015,378885,379756,380628,381501,382375,383250,384126,385003,385881,386760,387640,388521,389403,390286,391170,392055,392941,393828,394716,395605,396495,397386,398278,399171,400065,400960,401856,402753,403651,404550,405450,406351,407253,408156,409060,409965,410871,411778,412686,413595,414505,415416,416328,417241,418155,419070,419986,420903,421821,422740,423660,424581,425503,426426,427350,428275,429201,430128,431056,431985,432915,433846,434778,435711,436645,437580,438516,439453,440391,441330,442270,443211,444153,445096,446040,446985,447931,448878,449826,450775,451725,452676,453628,454581,455535,456490,457446,458403,459361,460320,461280,462241,463203,464166,465130,466095,467061,468028,468996,469965,470935,471906,472878,473851,474825,475800,476776,477753,478731,479710,480690,481671,482653,483636,484620,485605,486591,487578,488566,489555,490545,491536,492528,493521,494515,495510,496506,497503,498501,499500]
